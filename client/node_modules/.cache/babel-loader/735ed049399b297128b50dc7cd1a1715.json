{"ast":null,"code":"import _defineProperty from\"/Users/riyadh/Desktop/shopping-cart/Shopping_cart/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/riyadh/Desktop/shopping-cart/Shopping_cart/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/riyadh/Desktop/shopping-cart/Shopping_cart/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/riyadh/Desktop/shopping-cart/Shopping_cart/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/riyadh/Desktop/shopping-cart/Shopping_cart/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import Header from\"./header\";import{Link}from\"react-router-dom\";import Main from\"./Main\";function Login(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLogin=_useState2[0],setIsLogin=_useState2[1];//CHECK LOGIN\nuseEffect(function(){var checkLogin=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var token,verified;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=localStorage.getItem(\"tokenStore\");if(!token){_context.next=10;break;}_context.next=4;return axios.get(\"/users/verify\",{headers:{Authorization:token}});case 4:verified=_context.sent;setIsLogin(verified.data);if(!(verified.data===false)){_context.next=8;break;}return _context.abrupt(\"return\",localStorage.clear());case 8:_context.next=11;break;case 10:setIsLogin(false);case 11:case\"end\":return _context.stop();}}},_callee);}));return function checkLogin(){return _ref.apply(this,arguments);};}();checkLogin();},[]);var _useState3=useState({name:\"\",email:\"\",password:\"\",password2:\"\"}),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];var _useState5=useState(\" \"),_useState6=_slicedToArray(_useState5,2),err=_useState6[0],setErr=_useState6[1];var onChangeInput=function onChangeInput(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setUser(_objectSpread(_objectSpread({},user),{},_defineProperty({},name,value)));setErr(\"\");};var loginSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();_context2.prev=1;_context2.next=4;return axios.post(\"/users/login\",{username:user.name,email:user.email,password:user.password});case 4:res=_context2.sent;setUser({email:\"\",password:\"\"});setUser(user);localStorage.setItem(\"tokenStore\",res.data.token);setIsLogin(true);_context2.next=14;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](1);_context2.t0.response.data.msg&&setErr(_context2.t0.response.data.msg);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[1,11]]);}));return function loginSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",null,isLogin?/*#__PURE__*/React.createElement(Main,{setIsLogin:setIsLogin}):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(\"div\",{className:\"login\"},/*#__PURE__*/React.createElement(\"div\",{className:\"row mt-5\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-md-6 m-auto\"},/*#__PURE__*/React.createElement(\"div\",{className:\"card card-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\" alert-warning alert-dismissible fade show err-btn\"},err),/*#__PURE__*/React.createElement(\"h1\",{className:\"text-center mb-3 \"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-sign-in-alt\"}),\" Sign in\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:loginSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Email\"),/*#__PURE__*/React.createElement(\"input\",{type:\"email\",id:\"login-email\",name:\"email\",className:\"form-control\",placeholder:\"Enter Email\",required:true,value:user.email,onChange:onChangeInput})),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"label\",null,\"Password\"),/*#__PURE__*/React.createElement(\"input\",{type:\"password\",id:\"login-password\",name:\"password\",className:\"form-control\",placeholder:\"Enter Password\",required:true,value:user.password,autoComplete:\"true\",onChange:onChangeInput})),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary btn-block bg-primary\"},\"Sign in\")),/*#__PURE__*/React.createElement(\"p\",{className:\"lead mt-4\"},\"No Account? \",/*#__PURE__*/React.createElement(\"a\",{href:\"/register\"},\"Join us\")),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"lead mt-4\"},/*#__PURE__*/React.createElement(Link,{to:\"/resetpassword\"},\"Forget Password \")))))))));}export default Login;","map":{"version":3,"sources":["/Users/riyadh/Desktop/shopping-cart/Shopping_cart/client/src/component/Login.jsx"],"names":["React","useState","useEffect","axios","Header","Link","Main","Login","isLogin","setIsLogin","checkLogin","token","localStorage","getItem","get","headers","Authorization","verified","data","clear","name","email","password","password2","user","setUser","err","setErr","onChangeInput","e","target","value","loginSubmit","preventDefault","post","username","res","setItem","response","msg"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport Header from \"./header\";\nimport { Link } from \"react-router-dom\";\nimport Main from \"./Main\";\n\nfunction Login() {\n  const [isLogin, setIsLogin] = useState(false);\n\n  //CHECK LOGIN\n  useEffect(() => {\n    const checkLogin = async () => {\n      const token = localStorage.getItem(\"tokenStore\");\n      if (token) {\n        const verified = await axios.get(\"/users/verify\", {\n          headers: { Authorization: token },\n        });\n\n        setIsLogin(verified.data);\n        if (verified.data === false) return localStorage.clear();\n      } else {\n        setIsLogin(false);\n      }\n    };\n    checkLogin();\n  }, []);\n  const [user, setUser] = useState({\n    name: \"\",\n    email: \"\",\n    password: \"\",\n    password2: \"\",\n  });\n\n  const [err, setErr] = useState(\" \");\n\n  const onChangeInput = (e) => {\n    const { name, value } = e.target;\n    setUser({ ...user, [name]: value });\n    setErr(\"\");\n  };\n\n  const loginSubmit = async (e) => {\n    e.preventDefault();\n\n    try {\n      const res = await axios.post(\"/users/login\", {\n        username: user.name,\n        email: user.email,\n        password: user.password,\n      });\n      setUser({ email: \"\", password: \"\" });\n      setUser(user);\n\n      localStorage.setItem(\"tokenStore\", res.data.token);\n      setIsLogin(true);\n    } catch (err) {\n      err.response.data.msg && setErr(err.response.data.msg);\n    }\n  };\n\n  return (\n    <div>\n      {isLogin ? (\n        <Main setIsLogin={setIsLogin} />\n      ) : (\n        <div>\n          <Header />\n          <div className=\"login\">\n            <div className=\"row mt-5\">\n              <div className=\"col-md-6 m-auto\">\n                <div className=\"card card-body\">\n                  <div className=\" alert-warning alert-dismissible fade show err-btn\">\n                    {err}\n                  </div>\n                  <h1 className=\"text-center mb-3 \">\n                    <i className=\"fas fa-sign-in-alt\"></i> Sign in\n                  </h1>\n                  <form onSubmit={loginSubmit}>\n                    <div className=\"form-group\">\n                      <label>Email</label>\n                      <input\n                        type=\"email\"\n                        id=\"login-email\"\n                        name=\"email\"\n                        className=\"form-control\"\n                        placeholder=\"Enter Email\"\n                        required\n                        value={user.email}\n                        onChange={onChangeInput}\n                      />\n                    </div>\n                    <div className=\"form-group\">\n                      <label>Password</label>\n                      <input\n                        type=\"password\"\n                        id=\"login-password\"\n                        name=\"password\"\n                        className=\"form-control\"\n                        placeholder=\"Enter Password\"\n                        required\n                        value={user.password}\n                        autoComplete=\"true\"\n                        onChange={onChangeInput}\n                      />\n                    </div>\n                    <button\n                      type=\"submit\"\n                      className=\"btn btn-primary btn-block bg-primary\"\n                    >\n                      Sign in\n                    </button>\n                  </form>\n                  <p className=\"lead mt-4\">\n                    No Account? <a href=\"/register\">Join us</a>\n                  </p>\n                  <div>\n                    <p className=\"lead mt-4\">\n                      <Link to=\"/resetpassword\">Forget Password </Link>\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}